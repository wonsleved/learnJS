# Modules, introduction

## What is a module?

A module is a file. To make `import/export` work, browsers need `<script type="module">`.

```
export function sayHi(user) {
  alert(`Hello, ${user}!`);
}
```

```
import {sayHi} from './sayHi.js';
```

## Core module features

### Always “use strict”

### Module-level scope

Modules should `export` what they want to be accessible from outside and `import` what they need.

### A module code is evaluated only the first time when imported

If the same module is imported into multiple other modules, its code is executed only once, upon the first import. Then its exports are given to all further importers.

Exports are generated, and then they are shared between importers, so if something changes the exported object, other importers will see that.

### import.meta

### In a module, “this” is undefined

```
<script>
  alert(this); // window
</script>

<script type="module">
  alert(this); // undefined
</script>
```

## Browser-specific features

### Module scripts are deferred

- downloading external module scripts `<script type="module" src="...">` doesn’t block HTML processing, they load in parallel with other resources. 
- module scripts wait until the HTML document is fully ready (even if they are tiny and load faster than HTML), and then run. 
- relative order of scripts is maintained: scripts that go first in the document, execute first.

### Async works on inline scripts

For non-module scripts, the async attribute only works on external scripts. Async scripts run immediately when ready, independently of other scripts or the HTML document.

For module scripts, it works on inline scripts as well.

### External scripts

External scripts that have `type="module"` are different in two aspects:
1. External scripts with the same `src` run only once
2. if a module script is fetched from another origin, the remote server must supply a header `Access-Control-Allow-Origin` allowing the fetch.

### No “bare” modules allowed

In the browser, `import` must get either a relative or absolute URL. Modules without any path are called “bare” modules. Such modules are not allowed in `import`.

### Compatibility, “nomodule”

Old browsers do not understand `type="module"`. Scripts of an unknown type are just ignored. For them, it’s possible to provide a fallback using the `nomodule` attribute.

## Build tools

In production, people often use bundlers such as Webpack to bundle modules together for performance and other reasons.
